import{j as e,u as J,r as m}from"./vendor-others-CnHLUX9e.js";import{S as Y,H as Z}from"./Sidebar-CqIm_DoL.js";import{B as _,I as ee,C as S}from"./BreadcrumbNav-UyBSKmYg.js";import{I as x}from"./input-CzX8_0F_.js";import{T as ae}from"./textarea-DwRtrXMR.js";import{L as h}from"./label-PSaLDb4s.js";import{S as se}from"./switch-oJ7sErcF.js";import{b as oe,T as ie,f as re,g as te,h as le,d as F}from"./main-1fmfMNLN.js";import{f as ne,X as ce,I as de,i as me}from"./vendor-lucide-0MdzRPOT.js";import{q as D,c as P,w as k,n as I,e as A}from"./vendor-firebase-CsHq2m9l.js";import"./vendor-react-query-BsC494l1.js";const ue=({isValid:g})=>g?e.jsx("div",{className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center text-white",children:e.jsx(ne,{size:16})}):e.jsx("div",{className:"w-6 h-6 bg-red-500 rounded-full flex items-center justify-center text-white",children:e.jsx(ce,{size:16})}),Ce=()=>{const g=J(),{numeroProcesso:R,numeroHabitantes:b}=oe(),[N,L]=m.useState(!1),[j,V]=m.useState(null),[f,y]=m.useState(null),[C,w]=m.useState([]),[E,q]=m.useState({prefeito:{isValid:!0,message:null},vicePrefeito:{isValid:!0,message:null},secretarios:{isValid:!0,message:null},vereadores:{isValid:!0,message:null},presidenteCamara:{isValid:!0,message:null}}),[r,u]=m.useState({atoNormativo:"",legislatura:"",dataFixacao:"",anotacaoPlanilha:!1,numeroLei:"",numeroAcordao:"",ressalvaLivre:!1,viciosChecks:{},viciosDetails:{},"valor-0":"","valor-1":"","valor-2":"","valor-3":"","valor-4":""}),M=[{cargo:"Prefeito",valorKey:"valor-0",validationKey:"prefeito"},{cargo:"Vice-Prefeito",valorKey:"valor-1",validationKey:"vicePrefeito"},{cargo:"Secretários",valorKey:"valor-2",validationKey:"secretarios"},{cargo:"Vereadores",valorKey:"valor-3",validationKey:"vereadores"},{cargo:"Presidente da Câmara",valorKey:"valor-4",validationKey:"presidenteCamara"}],v=s=>{if(!s)return 0;let a=s.replace(/R\$|\s/g,"");if(a.includes(","))a=a.replace(/\./g,""),a=a.replace(",",".");else{const i=(a.match(/\./g)||[]).length;i===1&&a.endsWith(".")?a=a.slice(0,-1):i===1&&a.indexOf(".")===a.length-3||i>=1&&(a=a.replace(/\./g,""))}const o=parseFloat(a);return isNaN(o)?0:o},O=()=>{L(!N)},B=()=>{console.log("Clear screen action triggered"),u({atoNormativo:"",legislatura:"",dataFixacao:"",anotacaoPlanilha:!0,numeroLei:"",numeroAcordao:"",ressalvaLivre:!1,viciosChecks:{},viciosDetails:{},"valor-0":"","valor-1":"","valor-2":"","valor-3":"","valor-4":""})};m.useEffect(()=>{(async()=>{if(!r.legislatura){V(null),y(null),w([]);return}try{const a=r.legislatura.trim(),o=D(P(F,"SubsidiosDeputadosEstaduais"),k("AnoLegislatura","==",a),I(1)),i=await A(o);i.empty?V(null):V(i.docs[0].data());const n=D(P(F,"SubsidiosMinistrosSTF"),k("AnoLegislatura","==",a),I(1)),d=await A(n);d.empty?y(null):y(d.docs[0].data());const l=D(P(F,"PercentualSalarioDep"),k("AnoLegislatura","==",a)),c=(await A(l)).docs.map($=>$.data());w(c)}catch(a){console.error("Erro ao buscar dados do Firebase:",a),V(null),y(null),w([])}})()},[r.legislatura]);const K=m.useMemo(()=>{const s={prefeito:{isValid:!0,message:null},vicePrefeito:{isValid:!0,message:null},secretarios:{isValid:!0,message:null},vereadores:{isValid:!0,message:null},presidenteCamara:{isValid:!0,message:null}},a=v(r["valor-0"]||"0"),o=v(r["valor-1"]||"0"),i=v(r["valor-2"]||"0"),n=v(r["valor-3"]||"0"),d=v(r["valor-4"]||"0");if(j&&C.length>0){const l=C.sort((t,c)=>Math.min(t.minimo,t.maximo??1/0)-Math.min(c.minimo,c.maximo??1/0)).find(t=>{const c=Math.min(t.minimo,t.maximo??1/0),$=t.maximo===null||t.maximo===0?1/0:Math.max(t.minimo,t.maximo);return b>=c&&b<=$});if(l){const t=l.porcentagemValor/100,c=j.Valor*t;r["valor-3"]!==""&&(Number(n)>=c?s.vereadores={isValid:!1,message:`Subsídio (R$ ${n.toFixed(2)}) excede o teto de ${l.porcentagemValor}% do Dep. Estadual (Teto: R$ ${c.toFixed(2)}).`}:c>=Number(a)&&(s.vereadores={isValid:!1,message:`Teto calculado (R$ ${c.toFixed(2)}) é maior ou igual ao subsídio do Prefeito (R$ ${a.toFixed(2)}).`})),r["valor-4"]!==""&&(Number(d)>=c?s.presidenteCamara={isValid:!1,message:`Subsídio (R$ ${d.toFixed(2)}) excede o teto de ${l.porcentagemValor}% do Dep. Estadual (Teto: R$ ${c.toFixed(2)}).`}:c>=Number(a)&&(s.presidenteCamara={isValid:!1,message:`Teto calculado (R$ ${c.toFixed(2)}) é maior ou igual ao subsídio do Prefeito (R$ ${a.toFixed(2)}).`}))}else{const t=`Faixa percentual para ${b} habitantes não encontrada.`;Number(n)>0&&(s.vereadores={isValid:!1,message:t}),Number(d)>0&&(s.presidenteCamara={isValid:!1,message:t})}}else if((Number(n)>0||Number(d)>0)&&(!j||C.length===0)){const l=`Dados de Dep. Estadual ou Percentuais para a legislatura ${r.legislatura} não encontrados.`;Number(n)>0&&(s.vereadores={isValid:!1,message:l}),Number(d)>0&&(s.presidenteCamara={isValid:!1,message:l})}return Number(a)>0&&f?Number(a)>=f.Valor&&(s.prefeito={isValid:!1,message:`Subsídio do Prefeito (R$ ${a.toFixed(2)}) deve ser menor que o do Ministro STF (R$ ${f.Valor.toFixed(2)}).`}):Number(a)>0&&!f&&(s.prefeito={isValid:!1,message:`Dados do subsídio STF para a legislatura ${r.legislatura} não encontrados.`}),r["valor-1"]!==""&&Number(o)>=Number(a)&&(s.vicePrefeito={isValid:!1,message:`Subsídio do Vice-Prefeito (R$ ${o.toFixed(2)}) deve ser menor que o do Prefeito (R$ ${a.toFixed(2)}).`}),r["valor-2"]!==""&&Number(i)>=Number(a)&&(s.secretarios={isValid:!1,message:`Subsídio dos Secretários (R$ ${i.toFixed(2)}) deve ser menor que o do Prefeito (R$ ${a.toFixed(2)}).`}),s},[r,j,f,C,b]);m.useEffect(()=>{q(K)},[K]);const H=["1 - Ausência de Documentação Essencial","2 -A fixação dos subsídios do Prefeito, do Vice-Prefeito, dos Secretários e dos Vereadores, NÃO deu-se mediante lei de iniciativa da Câmara.","3 - NÃO houve declaração do Prefeito no ato de sanção","4 - A fixação do subsídio dos vereadores ocorreu por meio de outra norma.","5 -A Lei que fixou os subsídios dos vereadores ocorreu por meio de outra norma.","6 -Subsídio fixado excede ao teto regulamentar.","7 - Houve Desobediência ao Princípio da Anterioridade.","8 -houve alteração de norma para retirar a exigência da anterioridade","9 -Existe divergência entres als fixatório e Lei Municipal.","10 -O total da despesa com a remuneração dos vereadores ultrapassa o montante de 5% da receita do município.","11- Houve Desobedencia ao Princípio da Generalidade"],p=s=>{const{name:a,value:o}=s.target;if(a.startsWith("valor-")){const i=o.replace(/[^\d,]/g,"");u(n=>({...n,[a]:i}))}else u(i=>({...i,[a]:o}))},T=(s,a)=>{u(o=>({...o,[s]:a}))},z=(s,a)=>{const o=`vicio-${s}`;u(i=>{const n={...i.viciosChecks,[o]:a},d={...i.viciosDetails};return a&&(d[o]||(d[o]={ressalvaAV:!1,inputValue:""})),{...i,viciosChecks:n,viciosDetails:d}})},Q=(s,a)=>{const o=`vicio-${s}`;u(i=>({...i,viciosDetails:{...i.viciosDetails,[o]:{...i.viciosDetails[o]||{ressalvaAV:!1},inputValue:a}}}))},W=(s,a)=>{const o=`vicio-${s}`;u(i=>({...i,viciosDetails:{...i.viciosDetails,[o]:{...i.viciosDetails[o]||{inputValue:""},ressalvaAV:a}}}))},G=()=>{B()},U=()=>{g("/TratamentoLeis")},X=()=>{g("/Fixacao")};return e.jsxs("div",{className:"municipios-theme flex min-h-screen flex-col bg-gray-50",children:[e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(Y,{isOpen:N,setIsOpen:L}),e.jsxs("div",{className:`transition-all duration-300 ${N?"ml-64":"ml-0"}`,children:[e.jsx("div",{className:"flex justify-between items-center",children:e.jsx(Z,{toggleSidebar:O})}),e.jsx(_,{currentPage:"Fixação",sidebarOpen:N}),e.jsxs("main",{className:"min-h-screen bg-pattern bg-gray-100 py-8 px-4 ",children:[e.jsxs("div",{className:"max-w-5xl mx-auto bg-white rounded-lg shadow-md overflow-hidden ",children:[e.jsxs("div",{className:"p-6 ",children:[e.jsx("div",{className:"mt-[-20px] flex justify-end",children:e.jsx(ee,{onEraseClick:G,onBackClick:U,onNextClick:X})}),e.jsx("div",{className:"relative mb-8 text-primary text-center",children:e.jsxs("h1",{className:"text-2xl font-bold text-center mb-4 mt-[-20px]",children:["Fixação ",R&&`(${R})`]})}),e.jsxs("div",{className:"mb-6 space-y-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 md:items-center",children:[e.jsx(h,{htmlFor:"atoNormativo",className:"text-base font-medium w-128",children:"Ato Normativo que concedeu a Fixação dos Subsídios n.:"}),e.jsx(x,{id:"atoNormativo",name:"atoNormativo",value:r.atoNormativo,onChange:p,className:"w-[100px] md:max-w-xs",placeholder:"1.500/00"})]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 md:items-center",children:[e.jsx(h,{htmlFor:"legislatura",className:"text-base font-medium w-18",children:"A fixação dos subsídios refere-se a qual legislatura:"}),e.jsx(x,{id:"legislatura",name:"legislatura",value:r.legislatura,onChange:p,className:"w-[100px] md:max-w-xs",placeholder:"2020/2024"})]})]}),e.jsxs("div",{className:"mb-8 w-[80%] md:w-full",children:[e.jsx("h2",{className:"text-xl font-bold mb-4 text-center",children:"Sobre o valor dos subsídios:"}),e.jsxs("table",{className:"w-[70%] border-collapse text-center mx-auto",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-100",children:[e.jsx("th",{className:"w-64 border p-2 text-center",children:"Agente Político"}),e.jsx("th",{className:"border p-2 text-center",children:"Valor dos Subsídios"}),e.jsx("th",{className:"border p-2 text-center",children:"Válido?"})]})}),e.jsx("tbody",{children:M.map(s=>{const a=E[s.validationKey]||{isValid:!0,message:null},o=!!r[s.valorKey];return e.jsxs("tr",{children:[e.jsx("td",{className:"border p-2 text-left",children:s.cargo}),e.jsx("td",{className:"border-b p-2 flex text-center justify-center",children:e.jsx(x,{type:"text",name:s.valorKey,value:r[s.valorKey]||"",onChange:i=>{const n=i.target.value;u({...r,[s.valorKey]:n})},className:"w-32",placeholder:"R$ 0,00"})}),e.jsx("td",{className:"border p-2 w-22",children:o&&e.jsxs("div",{className:"flex justify-center items-center gap-1",children:[e.jsx(ue,{isValid:a.isValid}),!a.isValid&&a.message&&e.jsx(ie,{delayDuration:100,children:e.jsxs(re,{children:[e.jsx(te,{children:e.jsx(de,{size:16,className:"text-red-600 cursor-help"})}),e.jsx(le,{className:"bg-black text-white",children:e.jsx("p",{children:a.message})})]})})]})})]},s.validationKey)})})]})]}),e.jsxs("div",{className:"mb-6 flex flex-col md:flex-row gap-4 md:items-center",children:[e.jsx("span",{className:"text-base font-medium",children:"Data da Fixação:"}),e.jsxs("div",{className:"relative max-w-xs",children:[e.jsx(x,{name:"dataFixacao",value:r.dataFixacao,onChange:p,className:"pl-10",placeholder:"24/04/2000"}),e.jsx(me,{className:"absolute left-3 top-2.5 text-gray-500 h-5 w-5"})]})]}),e.jsxs("div",{className:"mb-6 flex items-center gap-2 border p-4 rounded bg-blue-50",children:[e.jsx(S,{id:"anotacao",checked:r.anotacaoPlanilha,onCheckedChange:s=>T("anotacaoPlanilha",!!s)}),e.jsx("label",{htmlFor:"anotacao",className:"text-blue-800 font-medium",children:"Anotação na planilha de controle de gastos"})]}),r.anotacaoPlanilha&&e.jsx("div",{className:"mb-8 p-4 border rounded-md bg-gray-50 text-sm",children:e.jsxs("p",{className:"mb-2",children:["Trata-se de procedimento de anotação, para fins de controle de gastos, da Lei nº",e.jsx(x,{name:"numeroLei",value:r.numeroLei,onChange:p,className:"inline-block w-24 mx-1",placeholder:"000/000"})," que que fixou os subsídios dos agentes políticos de MUNICÍPIO para a legislatura ",e.jsx("span",{className:"bg-white border px-2 py-0.5 rounded",children:"2020-2024"})," do Setor de Recursos, com a informação de que os dados da planilha de subsídios",e.jsx("span",{className:"bg-white border px-2 py-0.5 rounded mx-1",children:"2020-2023"})," foram atualizados em consonância com o disposto no Acórdão nº",e.jsx(x,{name:"numeroAcordao",value:r.numeroAcordao,onChange:p,className:"inline-block w-24 mx-1",placeholder:"000/000"}),"."]})})," ",e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-lg font-bold mb-4",children:"Vícios ou Ressalvas da Fixação de Subsídios:"}),e.jsxs("div",{className:"space-y-4",children:[" ",H.map((s,a)=>{const o=`vicio-${a}`,i=r.viciosChecks[o]||!1,n=r.viciosDetails[o]||{inputValue:"",ressalvaAV:!1},d=[0,3,5,6,7,9].includes(a);let l="";switch(a){case 0:l="Descreva a documentação ausente";break;case 3:l="Número da Lei";break;case 5:l="Qual(is) cargo(s) excedeu(eram) ao teto";break;case 6:l="Data da eleição";break;case 7:l="Art. e Lei alterados";break;case 9:l="Descreva a divergência";break;default:l="Detalhes"}return e.jsxs("div",{className:"p-3 border rounded-md bg-gray-50",children:[" ",e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[" ",e.jsx(S,{id:o,checked:i,onCheckedChange:t=>z(a,!!t)}),e.jsx(h,{htmlFor:o,className:"text-base font-normal",children:s})]}),i&&e.jsxs("div",{className:"pl-6 mt-2 space-y-2",children:[" ",d&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(h,{htmlFor:`${o}-input`,className:"text-sm whitespace-nowrap",children:[l,":"]}),e.jsx(x,{id:`${o}-input`,value:n.inputValue||"",onChange:t=>Q(a,t.target.value),placeholder:l,className:"flex-grow",type:a===6?"date":"text"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{htmlFor:`${o}-switch`,className:`text-sm ${n.ressalvaAV?"text-gray-500":"font-semibold text-blue-600"}`,children:"Ressalva"}),e.jsx(se,{id:`${o}-switch`,checked:n.ressalvaAV||!1,onCheckedChange:t=>W(a,t)}),e.jsx(h,{htmlFor:`${o}-switch`,className:`text-sm ${n.ressalvaAV?"font-semibold text-green-600":"text-gray-500"}`,children:"A/V"})]})]})]},a)})]})]}),e.jsxs("div",{className:"mb-8 flex items-center gap-2",children:[e.jsx(S,{id:"ressalvaLivre",checked:r.ressalvaLivre,onCheckedChange:s=>T("ressalvaLivre",!!s)}),e.jsx("label",{htmlFor:"ressalvaLivre",className:"font-medium",children:"Inserir Ressalva Livre"})]}),r.ressalvaLivre&&e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"font-medium mb-2",children:"Ressalva"}),e.jsx(ae,{className:"w-full h-32"})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Conferência do Texto de Fixação de Subsídios"}),e.jsx("div",{className:"border rounded-md w-full h-64"})]})]})," "]})," "]})]})," "]})," "]})};export{Ce as default};
