import{r as n,u as F,j as e,L as I}from"./vendor-others-CnHLUX9e.js";/* empty css                           */import{u as R,a as d,d as h}from"./main-1fmfMNLN.js";import{s as x,c as p,q as g,w as f,e as v,f as M}from"./vendor-firebase-CsHq2m9l.js";import{M as O,L as z,E as A,a as T}from"./vendor-lucide-0MdzRPOT.js";import"./vendor-react-query-BsC494l1.js";const X=()=>{const[i,N]=n.useState(""),[o,j]=n.useState(""),[l,y]=n.useState(!1),[U,w]=n.useState(""),{toast:t}=R(),b=F(),E=s=>{M(d,s).then(()=>{console.log("Link de redefinição de senha enviado com sucesso para: "+s),t({title:"Link de redefinição enviado",description:"Verifique seu e-mail para redefinir sua senha."})}).catch(a=>{let r="Ocorreu um erro ao enviar o email de redefinição. Verifique se o email está correto.";a.code==="auth/user-not-found"&&(r="Não existe usuário com este email."),t({title:"Erro ao enviar email de redefinição",description:r,variant:"destructive"}),console.error("Erro ao enviar o link de redefinição de senha:",a)})},S=()=>{const s=prompt("Por favor, insira seu email para redefinir sua senha:");s&&(w(s),E(s))},C=async s=>{if(s.preventDefault(),!i||!o){t({title:"Campos obrigatórios",description:"Por favor, preencha todos os campos.",variant:"destructive"});return}try{const a=i.includes("@");let r;if(a)r=await x(d,i,o);else{const c=p(h,"usuarios"),q=g(c,f("cpf","==",i)),u=await v(q);if(u.empty){t({title:"Erro ao logar",description:"Usuário não encontrado com este CPF.",variant:"destructive"});return}const D=u.docs[0].data().email;r=await x(d,D,o)}const k=r.user.uid,L=p(h,"usuario_cargo"),P=g(L,f("usuarioId","==",k)),m=(await v(P)).docs.map(c=>c.data().cargoId);console.log("User roles:",m),localStorage.setItem("userRoles",JSON.stringify(m)),t({title:"Login realizado",description:"Login realizado com sucesso!",className:"bg-green-500 text-white"}),b("/telaInicial")}catch(a){t({title:"Erro ao logar",description:a.message,variant:"destructive"}),console.error("Erro ao logar:",a)}};return e.jsx("div",{className:"login-register-theme",children:e.jsx("div",{className:"login-background min-h-screen flex items-center justify-center p-4",children:e.jsx("div",{className:"auth-card w-full max-w-md",children:e.jsxs("div",{className:"p-6 sm:p-8",children:[e.jsx("img",{src:"/LogoTCMGO.svg?v=1",alt:"Logo",className:"flex item-center h-17 mb-2"}),e.jsx("h1",{className:"text-2xl font-bold text-center text-gray-800 mb-2",children:"Sistema de Análise de Subsídios"}),e.jsx("h2",{className:"text-xl font-semibold text-center text-gray-700 mb-6",children:"Entrar"}),e.jsxs("form",{onSubmit:C,children:[e.jsxs("div",{className:"input-group",children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email ou CPF"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(O,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{id:"email",type:"text",placeholder:"Digite seu email ou CPF",className:"input-field pl-10",value:i,onChange:s=>N(s.target.value)})]})]}),e.jsxs("div",{className:"input-group",children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Senha"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(z,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{id:"password",type:l?"text":"password",placeholder:"Digite sua senha",className:"input-field pl-10 pr-10",value:o,onChange:s=>j(s.target.value)}),e.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center cursor-pointer",onClick:()=>y(!l),children:l?e.jsx(A,{className:"h-5 w-5 text-gray-400"}):e.jsx(T,{className:"h-5 w-5 text-gray-400"})})]})]}),e.jsx("button",{type:"submit",className:"auth-button mt-6",children:"Entrar"})]}),e.jsxs("div",{className:"mt-4 text-center text-sm",children:[e.jsx("p",{className:"text-gray-600",children:e.jsx("button",{onClick:S,className:"link font-medium",children:"Esqueci minha senha"})}),e.jsxs("p",{className:"mt-3 text-gray-600",children:["Não possui uma conta? ",e.jsx(I,{to:"/cadastrar",className:"link font-medium",children:"Cadastrar-se"})]})]})]})})})})};export{X as default};
