import{r as t,j as e,l as Y,n as Z,S as ee,p as se,u as ae,q as re,m as oe,s as te,v as ne}from"./vendor-others-nGXFMc50.js";import{c as d,e as ie,u as le,a as A,d as R}from"./main-DoHEbxbz.js";import{c as T,e as $,k as G,q as de,w as ce,T as me,f as xe}from"./vendor-firebase-qPp9PP76.js";/* empty css                                    */import{L as ue,I as f}from"./label-CkeaNeoR.js";import{B as p}from"./button-JiVVoAjw.js";import{A as V,U as fe,M as pe,S as he,b as je,c as ge}from"./vendor-lucide-Dr8crDAL.js";import"./vendor-react-query-sfLXeyXT.js";const I=t.forwardRef(({className:r,...a},o)=>e.jsx("div",{ref:o,className:d("rounded-lg border bg-card text-card-foreground shadow-sm",r),...a}));I.displayName="Card";const O=t.forwardRef(({className:r,...a},o)=>e.jsx("div",{ref:o,className:d("flex flex-col space-y-1.5 p-6",r),...a}));O.displayName="CardHeader";const U=t.forwardRef(({className:r,...a},o)=>e.jsx("h3",{ref:o,className:d("text-2xl font-semibold leading-none tracking-tight",r),...a}));U.displayName="CardTitle";const be=t.forwardRef(({className:r,...a},o)=>e.jsx("p",{ref:o,className:d("text-sm text-muted-foreground",r),...a}));be.displayName="CardDescription";const E=t.forwardRef(({className:r,...a},o)=>e.jsx("div",{ref:o,className:d("p-6 pt-0",r),...a}));E.displayName="CardContent";const ve=t.forwardRef(({className:r,...a},o)=>e.jsx("div",{ref:o,className:d("flex items-center p-6 pt-0",r),...a}));ve.displayName="CardFooter";const Ne=Y,B=t.createContext({}),C=({...r})=>e.jsx(B.Provider,{value:{name:r.name},children:e.jsx(Z,{...r})}),y=()=>{const r=t.useContext(B),a=t.useContext(H),{getFieldState:o,formState:i}=se(),l=o(r.name,i);if(!r)throw new Error("useFormField should be used within <FormField>");const{id:n}=a;return{id:n,name:r.name,formItemId:`${n}-form-item`,formDescriptionId:`${n}-form-item-description`,formMessageId:`${n}-form-item-message`,...l}},H=t.createContext({}),j=t.forwardRef(({className:r,...a},o)=>{const i=t.useId();return e.jsx(H.Provider,{value:{id:i},children:e.jsx("div",{ref:o,className:d("space-y-2",r),...a})})});j.displayName="FormItem";const g=t.forwardRef(({className:r,...a},o)=>{const{error:i,formItemId:l}=y();return e.jsx(ue,{ref:o,className:d(i&&"text-destructive",r),htmlFor:l,...a})});g.displayName="FormLabel";const b=t.forwardRef(({...r},a)=>{const{error:o,formItemId:i,formDescriptionId:l,formMessageId:n}=y();return e.jsx(ee,{ref:a,id:i,"aria-describedby":o?`${l} ${n}`:`${l}`,"aria-invalid":!!o,...r})});b.displayName="FormControl";const Ce=t.forwardRef(({className:r,...a},o)=>{const{formDescriptionId:i}=y();return e.jsx("p",{ref:o,id:i,className:d("text-sm text-muted-foreground",r),...a})});Ce.displayName="FormDescription";const ye=t.forwardRef(({className:r,children:a,...o},i)=>{const{error:l,formMessageId:n}=y(),h=l?String(l==null?void 0:l.message):a;return h?e.jsx("p",{ref:i,id:n,className:d("text-sm font-medium text-destructive",r),...o,children:h}):null});ye.displayName="FormMessage";function De(){const r=ae(),[a,o]=t.useState("perfil"),[i,l]=t.useState(!1),[n,h]=t.useState(!1),[v,D]=t.useState(""),[z,M]=t.useState([]),{userRoles:P,userName:w,userEmail:u,usercpf:F,updateUser:_}=ie();t.useEffect(()=>{(async()=>{const x=T(R,"cargos"),N=(await $(x)).docs.map(q=>q.data().nome);M(N)})()},[]);const J=async()=>{if(v.trim()!=="")try{const s=T(R,"cargos");await G(s,{nome:v}),M([...z,v]),D(""),c({title:"Cargo adicionado com sucesso!",className:"bg-green-500 text-white"})}catch(s){console.error("Erro ao adicionar cargo:",s),c({title:"Erro ao adicionar cargo. Tente novamente.",variant:"destructive"})}},{toast:c}=le(),[k,L]=t.useState(null),K=async()=>{try{const s=T(R,"tokens"),x=de(s,ce("usado","==",!1)),S=await $(x);if(!S.empty){const X=S.docs[0].data().token;L(X),l(!0);return}const N=ne();await G(s,{data_geracao:me.now(),token:N,usado:!1}),L(N)}catch(s){console.error("Error generating token:",s),c({title:"Erro ao gerar token",description:"Tente novamente.",variant:"destructive"})}},Q=()=>{u&&xe(A,u).then(()=>{console.log("Link de redefinição de senha enviado com sucesso para: "+u),c({title:"Link de redefinição enviado",description:"Verifique seu e-mail para redefinir sua senha."})}).catch(s=>{let x="Ocorreu um erro ao enviar o email de redefinição. Verifique se o email está correto.";s.code==="auth/user-not-found"&&(x="E-mail não encontrado no banco de dados."),c({title:"Erro ao enviar email de redefinição",description:x,variant:"destructive"}),console.error("Erro ao enviar o link de redefinição de senha:",s)})},m=re({defaultValues:{nome:w,email:u,cargos:P,cpf:F}});t.useEffect(()=>{m.reset({nome:w,email:u,cpf:F})},[w,u,F,m]);const W=async s=>{console.log("Form submitted:",s);try{await _({userName:s.nome,userEmail:s.email,usercpf:s.cpf}),c({title:"Perfil atualizado com sucesso!",className:"bg-green-500 text-white"})}catch(x){console.error("Erro ao atualizar o perfil:",x),c({title:"Erro ao atualizar o perfil. Tente novamente.",variant:"destructive"})}};return e.jsx("div",{className:"dashboard-theme container mx-auto py-6 px-4 md:px-6",children:e.jsxs(oe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:[e.jsxs("div",{className:"flex items-center mb-6 cursor-pointer",onClick:()=>r("/telaInicial"),children:[e.jsx(V,{className:"mr-2 text-tribunal-blue",size:24}),e.jsx("h1",{className:"text-3xl font-bold text-tribunal-blue",children:"Configurações"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-6",children:[e.jsx(I,{className:"md:col-span-3 shadow-md",children:e.jsx(E,{className:"p-0",children:e.jsxs("nav",{className:"flex flex-col",children:[[{id:"perfil",label:"Perfil",icon:e.jsx(fe,{size:18})},{id:"conta",label:"Conta",icon:e.jsx(pe,{size:18})},{id:"admin",label:"Área de administrador",icon:e.jsx(he,{size:18})}].map(s=>e.jsxs("button",{className:`flex items-center gap-3 p-4 text-left transition-colors hover:bg-gray-100 ${a===s.id?"bg-tribunal-gold/10 text-tribunal-gold border-l-4 border-tribunal-gold":"text-gray-700"}`,onClick:()=>o(s.id),children:[s.icon,e.jsx("span",{children:s.label})]},s.id)),e.jsxs("button",{className:"flex items-center gap-3 p-4 text-left text-red-500 hover:bg-red-50 mt-auto border-t",onClick:()=>{window.confirm("Deseja realmente sair?")&&A.signOut().then(()=>{r("/login")})},children:[e.jsx(je,{size:18}),e.jsx("span",{children:"Sair"})]})]})})}),e.jsxs(I,{className:"md:col-span-9 shadow-md",children:[e.jsx(O,{children:e.jsxs(U,{className:"text-2xl text-tribunal-blue",children:[a==="perfil"&&"Informações de Perfil",a==="conta"&&"Configurações de Conta",a==="seguranca"&&"Segurança",a==="admin"&&e.jsxs(e.Fragment,{children:[n&&e.jsxs("div",{className:"flex items-center cursor-pointer",onClick:()=>h(!1),children:[e.jsx(V,{className:"mr-2 text-tribunal-blue",size:24}),e.jsx("span",{children:"Área de administrador"})]}),!n&&e.jsx("span",{children:"Área de administrador"})]})]})}),e.jsx(E,{children:e.jsx(Ne,{...m,children:e.jsxs("form",{onSubmit:m.handleSubmit(s=>{a==="perfil"&&W(s)}),className:"space-y-6",children:[a==="perfil"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex flex-col sm:flex-row gap-6 items-start rounded-lg border p-4",children:e.jsx("div",{className:"flex-1 space-y-4 ",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx(C,{control:m.control,name:"nome",render:({field:s})=>e.jsxs(j,{children:[e.jsx(g,{children:"Nome completo"}),e.jsx(b,{children:e.jsx(f,{...s})})]})}),e.jsx(C,{control:m.control,name:"cpf",render:({field:s})=>e.jsxs(j,{children:[e.jsx(g,{children:"CPF"}),e.jsx(b,{children:e.jsx(f,{...s})})]})}),e.jsx(C,{control:m.control,name:"email",render:({field:s})=>e.jsxs(j,{children:[e.jsx(g,{children:"Email"}),e.jsx(b,{children:e.jsx(f,{...s,type:"email"})})]})}),e.jsx(C,{control:m.control,name:"cargos",render:({field:s})=>e.jsxs(j,{children:[e.jsx(g,{children:"Cargos"}),e.jsx(b,{children:e.jsx(f,{...s,value:P.join(", "),disabled:!0})})]})})]})})}),e.jsx("div",{className:"flex justify-end space-x-4 pt-4 border-t",children:e.jsx(p,{type:"submit",className:"bg-tribunal-gold hover:bg-tribunal-gold/90",children:"Salvar alterações"})})]}),a==="conta"&&e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"rounded-lg border p-4",children:[e.jsx("div",{className:"font-medium",children:"Alterar senha"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Receba um e-mail para alterar sua senha."}),e.jsx(p,{variant:"outline",onClick:Q,children:"Alterar senha"})]})}),a==="admin"&&e.jsxs("div",{className:"space-y-4",children:[!n&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"rounded-lg border p-4",children:[e.jsx("div",{className:"font-medium",children:"Cargos"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Área para edição e inclusão de cargos."}),e.jsx(p,{variant:"outline",onClick:()=>h(!n),children:"Cargos"})]}),e.jsxs("div",{className:"rounded-lg border p-4",children:[e.jsx("div",{className:"font-medium",children:"Gerar Token"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Gere um Token para um novo cadastro."}),e.jsx(p,{variant:"outline",onClick:K,children:"Gerar Token"}),i&&k&&e.jsxs("div",{className:"flex items-center space-x-2 mt-2",children:[e.jsx(f,{type:"text",value:k,readOnly:!0,className:"w-full md:w-auto"}),e.jsx(te.CopyToClipboard,{text:k,onCopy:()=>c({title:"Token copiado",description:"Token copiado para a área de transferência."}),children:e.jsx(p,{variant:"outline",children:"Copiar Token"})})]})]})]}),n&&e.jsxs("div",{className:"flex justify-between rounded-lg border p-4",children:[e.jsxs("div",{className:"w-1/3",children:[e.jsxs("div",{className:"relative w-full",children:[e.jsx(f,{type:"text",placeholder:"Novo cargo",value:v,onChange:s=>D(s.target.value),className:"w-full pl-8"}),e.jsx(ge,{className:"absolute left-2 top-1/2 transform -translate-y-1/2 text-tribunal-blue",size:20})]}),e.jsx(p,{onClick:J,className:"mt-2",children:"Adicionar Cargo"})]}),e.jsxs("div",{className:"w-1/2 flex flex-col items-center justify-center",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4 text-tribunal-blue",children:"Cargos existentes"}),e.jsx("ul",{className:"list-disc list-inside bg-gray-100 p-4 rounded-lg shadow-md",children:z.map(s=>e.jsx("li",{className:"py-1 text-gray-700",children:s},s))})]})]})]})]})})})]})]})]})})}export{De as default};
