import{r as t,u as G,j as e,L as J}from"./vendor-others-Di0KkQDI.js";/* empty css                           */import{u as O,d as o,a as W}from"./main-ByvVTPME.js";import{c as N,q as j,w as h,e as y,h as B,j as w,d as g,u as H}from"./vendor-firebase-DUe4cX6Q.js";import{K as Q,U as V,C as X,M as Y,L as C,E as b,a as k}from"./vendor-lucide-DmcWVqu_.js";import"./vendor-react-query-De-ebuA0.js";const ne=()=>{const[r,S]=t.useState(""),[i,E]=t.useState(""),[c,D]=t.useState(""),[d,P]=t.useState(""),[m,F]=t.useState(""),[u,q]=t.useState(""),[x,L]=t.useState(!1),[p,T]=t.useState(!1),{toast:a}=O(),z=G(),A=async s=>{if(s.preventDefault(),!r||!i||!c||!d||!m||!u){a({title:"Campos obrigatórios",description:"Por favor, preencha todos os campos.",variant:"destructive"});return}if(i!==c){a({title:"Erro",description:"As senhas não coincidem.",variant:"destructive"});return}try{const l=N(o,"tokens"),I=j(l,h("token","==",d),h("usado","==",!1)),v=await y(I);if(v.empty){a({title:"Erro",description:"Token inválido ou já utilizado.",variant:"destructive"});return}const M=v.docs[0].id,n=(await B(W,r,i)).user.uid,U=new Date;await w(g(o,"usuarios",n),{id:n,email:r,NomeCompleto:m,cpf:u,CriadoEm:U});const _=N(o,"cargos"),K=j(_,h("nome","==","Servidor")),f=await y(K);if(f.empty){a({title:"Erro",description:"Cargo 'Servidor' não encontrado.",variant:"destructive"});return}const R=f.docs[0].id;await w(g(o,"usuario_cargo",n),{usuario_id:n,cargo_id:R}),await H(g(o,"tokens",M),{usado:!1}),a({title:"Cadastro realizado",description:"Cadastro realizado com sucesso!",className:"bg-green-500 text-white"}),z("/login")}catch(l){console.error("Error ao cadastrar:",l),a({title:"Erro ao cadastrar",description:l.message,variant:"destructive"})}};return e.jsx("div",{className:"login-register-theme",children:e.jsx("div",{className:"login-background min-h-screen flex items-center justify-center p-4",children:e.jsx("div",{className:"auth-card w-full max-w-md",children:e.jsxs("div",{className:"p-6 sm:p-8",children:[e.jsx("img",{src:"/LogoTCMGO.svg?v=1",alt:"Logo",className:"flex item-center h-17 mb-2"}),e.jsx("h1",{className:"text-2xl font-bold text-center text-gray-800 mb-2",children:"Sistema de Análise de Subsídios"}),e.jsx("h2",{className:"text-xl font-semibold text-center text-gray-700 mb-3",children:"Cadastrar-se"}),e.jsxs("form",{onSubmit:A,children:[e.jsxs("div",{className:"input-group",children:[e.jsx("label",{htmlFor:"token",className:"block text-sm font-medium text-gray-700",children:"Token"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(Q,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{id:"token",type:"text",placeholder:"Digite seu token",className:"input-field pl-10",value:d,onChange:s=>P(s.target.value)})]})]}),e.jsxs("div",{className:"input-group",children:[e.jsx("label",{htmlFor:"NomeCompleto",className:"block text-sm font-medium text-gray-700",children:"Nome Completo"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(V,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{id:"NomeCompleto",type:"text",placeholder:"Digite seu nome completo",className:"input-field pl-10",value:m,onChange:s=>F(s.target.value)})]})]}),e.jsxs("div",{className:"input-group",children:[e.jsx("label",{htmlFor:"cpf",className:"block text-sm font-medium text-gray-700",children:"CPF"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(X,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{id:"cpf",type:"text",placeholder:"Digite seu CPF",className:"input-field pl-10",value:u,onChange:s=>q(s.target.value)})]})]}),e.jsxs("div",{className:"input-group",children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(Y,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{id:"email",type:"email",placeholder:"Digite seu email",className:"input-field pl-10",value:r,onChange:s=>S(s.target.value)})]})]}),e.jsxs("div",{className:"input-group",children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Senha"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(C,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{id:"password",type:x?"text":"password",placeholder:"Digite sua senha",className:"input-field pl-10 pr-10",value:i,onChange:s=>E(s.target.value)}),e.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center cursor-pointer",onClick:()=>L(!x),children:x?e.jsx(b,{className:"h-5 w-5 text-gray-400"}):e.jsx(k,{className:"h-5 w-5 text-gray-400"})})]})]}),e.jsxs("div",{className:"input-group",children:[e.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700",children:"Confirmar Senha"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(C,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{id:"confirmPassword",type:p?"text":"password",placeholder:"Confirme sua senha",className:"input-field pl-10 pr-10",value:c,onChange:s=>D(s.target.value)}),e.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center cursor-pointer",onClick:()=>T(!p),children:p?e.jsx(b,{className:"h-5 w-5 text-gray-400"}):e.jsx(k,{className:"h-5 w-5 text-gray-400"})})]})]}),e.jsx("button",{type:"submit",className:"auth-button mt-6",children:"Cadastrar-se"})]}),e.jsx("div",{className:"mt-6 text-center text-sm",children:e.jsxs("p",{className:"text-gray-600",children:["Já possui uma conta? ",e.jsx(J,{to:"/login",className:"link font-medium",children:"Entrar"})]})})]})})})})};export{ne as default};
