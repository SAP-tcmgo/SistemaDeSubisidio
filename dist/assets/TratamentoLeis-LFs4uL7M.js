import{u as M,r as i,j as e,a3 as G,a4 as P,aa as z,ab as I}from"./vendor-others-2QI88d8I.js";import{S as V,H as Q}from"./Sidebar-Db51tiMS.js";import{C as m,D as q,a as B,b as J,c as K,d as U}from"./dialog-CLlRTdNA.js";import{L as x,I as W}from"./label-CmJOcWah.js";import{b as X}from"./main-DUA0lFe-.js";import{P as Y,a as Z,T as _}from"./vendor-lucide-BO8tS8Cz.js";import"./vendor-firebase-Ds55KBa6.js";import"./vendor-react-query-WHUu8DGD.js";const ne=()=>{const b=M(),[h,g]=i.useState(!1),{municipio:r,numeroHabitantes:S,setNumeroHabitantes:l,doQueSeTrata:c,setDoQueSeTrata:k,leis:j,setLeis:ee,leisColare:N,setLeisColare:v,numeroProcesso:C}=X(),[u,n]=i.useState([]),[y,L]=i.useState([]),[w,p]=i.useState(null),[O,f]=i.useState(!1),[T,$]=i.useState(!1);i.useEffect(()=>{(async()=>{if(r&&r.codigo)try{const t=(await I.get(`https://apisidra.ibge.gov.br/values/t/4714/n6/${r.codigo}/v/93/p/2022`)).data[1],o=(t==null?void 0:t.V)||"0";l(parseInt(o,10))}catch(a){console.error("Erro ao buscar população:",a),l(0)}else l(0)})()},[r==null?void 0:r.codigo,l,r]),i.useEffect(()=>{(async()=>{if(r&&r.codigo){f(!0),p(null),n([]);try{const a=await I.get(`/api/colare/${r.codigo}/legislacoes`);n(a.data||[])}catch(a){console.error("Erro ao buscar leis do COLARE:",a),p("Falha ao buscar leis do COLARE. Verifique a conexão ou o código do município."),n([])}finally{f(!1)}}else n([]),f(!1),p(null)})()},[r==null?void 0:r.codigo,r]);const E=s=>{const a=s.anoNorma%100;return`Lei Municipal n.: ${s.numeroNorma}/${a}, ${s.ementa}`},A=s=>{const a=E(s);if(!y.includes(s.idEnvioColare)){const t={id:s.idEnvioColare,text:a};v(o=>[...o,t]),L(o=>[...o,s.idEnvioColare])}},R=s=>{v(a=>a.filter(t=>t.id!==s)),L(a=>a.filter(t=>t!==s))},D=()=>{g(!h)},d=s=>{const a=c.includes(s)?c.filter(t=>t!==s):[...c,s];k(a)},F=s=>{const a=parseInt(s.target.value.replace(/\D/g,""),10);l(isNaN(a)?0:a)},H=s=>typeof s!="number"||isNaN(s)?"0":s.toLocaleString("pt-BR");return e.jsx("div",{className:"municipios-theme flex min-h-screen flex-col bg-gray-50",children:e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(V,{isOpen:h,setIsOpen:g}),e.jsxs("div",{className:`transition-all duration-300 ${h?"ml-64":"ml-0"}`,children:[e.jsx("div",{className:"flex justify-between items-center",children:e.jsx(Q,{toggleSidebar:D})}),e.jsx("main",{className:"min-h-screen bg-pattern bg-gray-100 py-8 px-4 ",children:e.jsx("div",{className:"max-w-5xl mx-auto bg-white rounded-lg shadow-md overflow-hidden ",children:e.jsxs("div",{className:"p-6 ",children:[e.jsxs("div",{className:"relative mb-8 text-primary text-center",children:[e.jsxs("h1",{className:"text-2xl font-bold",children:["Trata-se de ",C&&`(${C})`]}),e.jsxs("div",{className:"absolute top-0 right-0 h-full flex items-center space-x-4",children:[e.jsx(G,{onClick:()=>b("/telaInicial"),className:"cursor-pointer text-tribunal-blue",size:24}),e.jsx(P,{className:"cursor-pointer text-tribunal-blue",size:24}),e.jsx(z,{onClick:()=>b("/MunicipioEResponsaveis"),className:"cursor-pointer text-tribunal-blue",size:26})]})]}),e.jsxs("div",{className:"text-gray-700 flex flex-wrap gap-6 mb-8",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(m,{id:"fixacao",checked:c.includes("fixacao"),onCheckedChange:()=>d("fixacao")}),e.jsx(x,{htmlFor:"fixacao",className:"text-sm",children:"Fixação"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(m,{id:"revisaoGeral",checked:c.includes("revisaoGeral"),onCheckedChange:()=>d("revisaoGeral")}),e.jsx(x,{htmlFor:"revisaoGeral",className:"text-sm",children:"Revisão Geral Anual"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(m,{id:"decimoTerceiro",checked:c.includes("decimoTerceiro"),onCheckedChange:()=>d("decimoTerceiro")}),e.jsx(x,{htmlFor:"decimoTerceiro",className:"text-sm",children:"Décimo Terceiro"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(m,{id:"ferias",checked:c.includes("ferias"),onCheckedChange:()=>d("ferias")}),e.jsx(x,{htmlFor:"ferias",className:"text-sm",children:"Férias"})]})]}),e.jsxs("div",{className:"text-gray-700 mb-8",children:[e.jsxs("h2",{className:"mb-2 font-medium text-sm",children:["Número de Habitantes no município de ",(r==null?void 0:r.nome)||"..."]}),e.jsx(W,{type:"text",value:H(S),onChange:F,className:"border-2 border-gray-300 h-12 w-32",placeholder:"0"})]}),e.jsxs("div",{className:"text-gray-700 mb-8",children:[e.jsxs("h2",{className:"mb-2 font-medium text-sm",children:["Lista resumida das Leis acerca da política inflacionária do município ",(r==null?void 0:r.nome)||"...",":"]}),e.jsx("div",{className:"border border-gray-300 rounded-md text-sm",children:j.length>0?j.map((s,a)=>e.jsx("div",{className:` p-4 flex justify-between items-center ${a!==0?"border-t border-gray-300":""}`,children:e.jsx("span",{children:s})},a)):e.jsx("div",{className:"p-4 text-gray-500 italic",children:"Nenhuma lei inflacionária cadastrada."})})]}),e.jsxs("div",{className:"text-gray-700 mb-8 text-sm",children:[e.jsxs("h2",{className:"mb-2 font-medium",children:["Lista resumida das Leis específicas (cadastradas no COLARE) do município ",(r==null?void 0:r.nome)||"...",":"]}),e.jsxs("div",{className:"border border-gray-300 rounded-md h-64 overflow-y-auto",children:[" ",O?e.jsx("div",{className:"p-4 text-gray-500 italic",children:"Carregando leis do COLARE..."}):w?e.jsx("div",{className:"p-4 text-red-600 italic",children:w}):u.length>0?u.map(s=>{const a=y.includes(s.idEnvioColare);return e.jsxs("div",{className:`p-4 flex justify-between items-center border-t border-gray-300 first:border-t-0 ${a?"bg-green-100":""}`,children:[e.jsx("span",{className:"flex-1 pr-4",children:E(s)})," ",e.jsx("button",{className:`text-primary hover:text-primary/80 p-1 rounded ${a?"opacity-50 cursor-not-allowed":""}`,onClick:()=>A(s),disabled:a,"aria-label":`Incluir lei ${s.numeroNorma}/${s.anoNorma%100}`,children:e.jsx(Y,{className:"h-5 w-5"})})]},s.idEnvioColare)}):e.jsx("div",{className:"p-4 text-gray-500 italic",children:"Nenhuma lei específica (COLARE) encontrada para este município."})]}),u.length>0&&e.jsxs(q,{open:T,onOpenChange:$,children:[e.jsx(B,{asChild:!0,children:e.jsx("div",{className:"pt-4 flex items-center text-sm",children:e.jsxs("button",{className:"flex items-center space-x-2 text-primary hover:text-primary/80",children:[e.jsx(Z,{className:"h-5 w-5"}),e.jsx("span",{className:"font-medium",children:"Visualizar lista completa incluída"})]})})}),e.jsxs(J,{className:"sm:max-w-[600px] bg-white",children:[" ",e.jsx(K,{children:e.jsx(U,{className:"text-center text-lg font-semibold text-gray-800",children:"Leis Incluídas"})}),e.jsxs("div",{className:"py-4 max-h-[400px] overflow-y-auto",children:[" ",N.length>0?e.jsx("ul",{className:"space-y-2",children:N.map(s=>e.jsxs("li",{className:"flex justify-between items-center text-sm text-gray-700 border-b border-gray-200 pb-2 last:border-b-0",children:[e.jsx("span",{className:"flex-1 pr-2",children:s.text})," ",e.jsxs("button",{onClick:()=>R(s.id),className:"text-red-500 hover:text-red-700 p-1 rounded","aria-label":`Remover lei ${s.text.substring(0,20)}...`,children:[e.jsx(_,{className:"h-4 w-4"})," "]})]},s.id))}):e.jsx("p",{className:"text-sm text-gray-500 italic text-center",children:"Nenhuma lei foi incluída ainda."})]})]})]})]})]})})})]})]})})};export{ne as default};
