import{j as a,r as c,u as na,al as k}from"./vendor-others-CnHLUX9e.js";import{S as ca,H as da}from"./Sidebar-CqIm_DoL.js";import{I as d}from"./input-CzX8_0F_.js";import{B as Q}from"./button-CHAtIAMY.js";import{C as $,b as z,c as I,a as H}from"./card-_nGB1AWh.js";import{X as ma,A as ua,i as ea}from"./vendor-lucide-0MdzRPOT.js";import{d as l}from"./main-1fmfMNLN.js";import{e as b,c as u,q as O,w as T,d as B,u as sa,k as q,m as xa}from"./vendor-firebase-CsHq2m9l.js";/* empty css                                    */import"./vendor-react-query-BsC494l1.js";const pa=({index:m,maximo:S,minimo:M,porcentagem:p,onMaximoChange:y,onMinimoChange:D,onPorcentagemChange:L,onRemove:C,isRemovable:w})=>a.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-start md:items-center p-4 border border-gray-200 rounded-md bg-white",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("label",{htmlFor:`maximo-${m}`,className:"block text-sm font-medium text-gray-700 mb-1",children:"De"}),a.jsx(d,{id:`maximo-${m}`,type:"number",min:"0",value:S,onChange:x=>y(x.target.value),placeholder:"Mínimo",className:"w-full"})]}),a.jsxs("div",{className:"flex-1",children:[a.jsx("label",{htmlFor:`minimo-${m}`,className:"block text-sm font-medium text-gray-700 mb-1",children:"a"}),a.jsx(d,{id:`minimo-${m}`,type:"number",min:"0",value:M,onChange:x=>D(x.target.value),placeholder:"Máximo",className:"w-full"})]}),a.jsxs("div",{className:"flex-1",children:[a.jsx("label",{htmlFor:`porcentagem-${m}`,className:"block text-sm font-medium text-gray-700 mb-1",children:"Percentual (%)"}),a.jsx(d,{id:`porcentagem-${m}`,type:"number",min:"0",max:"100",value:p,onChange:x=>L(x.target.value),placeholder:"Percentual",className:"w-full"})]}),w&&a.jsx("div",{className:"mt-8",children:a.jsx(Q,{type:"button",variant:"ghost",size:"sm",onClick:C,className:"text-red-500 hover:text-red-700 hover:bg-red-50",children:a.jsx(ma,{size:20})})})]}),La=()=>{const[m,S]=c.useState(!1),M=na(),[p,y]=c.useState(""),[D,L]=c.useState(""),[C,w]=c.useState(""),[x,U]=c.useState(""),[R,W]=c.useState(""),[J,X]=c.useState(""),[G,K]=c.useState(""),[Y,Z]=c.useState(""),[g,V]=c.useState([{id:"1",maximo:"",minimo:"10000",porcentagem:"20"}]);c.useEffect(()=>{(async()=>{try{(await b(u(l,"SubsidiosDeputadosEstaduais"))).forEach(n=>{const o=n.data();y(o.AnoLegislatura||""),L(o.Valor?o.Valor.toString():""),w(o.fixadoPelaLei||""),U(o.dataEntradaVigorLei||"")}),(await b(u(l,"SubsidiosMinistrosSTF"))).forEach(n=>{const o=n.data();W(o.AnoLegislatura||""),X(o.Valor?o.Valor.toString():""),K(o.fixadoPelaLei||""),Z(o.dataEntradaVigorLei||"")});const i=await b(u(l,"PercentualSalarioDep")),h=[];i.forEach(n=>{const o=n.data(),f=o.NrHabitantes,j=f.split(" - ");let v="",r="";j.length===2?(v=j[0].replace(/\./g,""),r=j[1].replace(/\./g,"")):f.startsWith("Acima de ")&&(v=f.replace("Acima de ","").replace(/\./g,""),r="");const N=o.PercentualUtilizado?o.PercentualUtilizado.replace("%",""):"";h.push({id:n.id,maximo:v,minimo:r,porcentagem:N})}),V(n=>h.length>0?h:n)}catch(s){console.error("Error fetching data from Firebase:",s),k("Erro ao carregar dados!",{description:"Ocorreu um erro ao tentar carregar as informações do Firebase. Verifique o console para mais detalhes."})}})()},[]);const ta=()=>{const e=g[g.length-1],s=e?e.minimo:"";V(t=>[...t,{id:Date.now().toString(),maximo:s,minimo:"",porcentagem:""}])},oa=e=>{V(g.filter(s=>s.id!==e))},P=(e,s,t)=>{V(g.map(i=>i.id===e?{...i,[s]:t}:i))},_=e=>{if(!e)return 0;let s=e.replace(/R\$|\s/g,"");if(s.includes(","))s=s.replace(/\./g,""),s=s.replace(",",".");else{const i=(s.match(/\./g)||[]).length;i===1&&s.endsWith(".")?s=s.slice(0,-1):i===1&&s.indexOf(".")===s.length-3||i>=1&&(s=s.replace(/\./g,""))}const t=parseFloat(s);return isNaN(t)?0:t},ia=async e=>{e.preventDefault();const s=(t,i)=>i===null||i===1/0?`Acima de ${t.toLocaleString("pt-BR")}`:`${t.toLocaleString("pt-BR")} - ${i.toLocaleString("pt-BR")}`;try{const t={AnoLegislatura:p,Valor:_(D),fixadoPelaLei:C,dataEntradaVigorLei:x},i=O(u(l,"SubsidiosDeputadosEstaduais"),T("AnoLegislatura","==",p)),h=await b(i);if(h.docs.length>0){const r=B(l,"SubsidiosDeputadosEstaduais",h.docs[0].id);await sa(r,t)}else await q(u(l,"SubsidiosDeputadosEstaduais"),t);const n={AnoLegislatura:R,Valor:_(J),fixadoPelaLei:G,dataEntradaVigorLei:Y},o=O(u(l,"SubsidiosMinistrosSTF"),T("AnoLegislatura","==",R)),f=await b(o);if(f.docs.length>0){const r=B(l,"SubsidiosMinistrosSTF",f.docs[0].id);await sa(r,n)}else await q(u(l,"SubsidiosMinistrosSTF"),n);const j=O(u(l,"PercentualSalarioDep"),T("AnoLegislatura","==",p)),v=await b(j);for(const r of v.docs)await xa(B(l,"PercentualSalarioDep",r.id));for(const r of g){const N=parseInt(r.maximo)||0,aa=r.minimo,F=aa?parseInt(aa):null;let A,E;F===null?(A=N,E=null):(A=Math.min(N,F),E=Math.max(N,F));const la={AnoLegislatura:p,NrHabitantes:s(A,E),PercentualUtilizado:`${r.porcentagem}%`,minimo:A,maximo:E,porcentagemValor:parseInt(r.porcentagem)||0};await q(u(l,"PercentualSalarioDep"),la)}k("Dados salvos com sucesso!",{description:"As informações do administrador foram cadastradas no Firebase."})}catch(t){console.error("Erro ao salvar dados no Firebase:",t),k("Erro ao salvar dados!",{description:"Ocorreu um erro ao tentar salvar as informações no Firebase. Verifique o console para mais detalhes."})}},ra=()=>{S(!m)};return a.jsxs("div",{className:"dashboard-theme min-h-screen bg-gray-50",children:[a.jsx(ca,{isOpen:m,setIsOpen:S}),a.jsxs("div",{className:`flex flex-col flex-1 transition-all duration-300 ease-in-out ${m?"ml-64":"ml-0"}`,children:[a.jsx(da,{toggleSidebar:ra}),a.jsxs("main",{className:"flex-1 p-6",children:[a.jsxs("div",{className:"flex items-center mb-6 cursor-pointer",onClick:()=>M("/telaInicial"),children:[a.jsx(ua,{className:"mr-2 text-tribunal-blue",size:24}),a.jsx("h1",{className:"text-3xl font-bold text-tribunal-blue",children:"Cadastro de Administrador"})]}),a.jsxs("form",{onSubmit:ia,className:"w-full max-w-6xl mx-auto space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:[" ",a.jsxs($,{className:"md:col-span-1 h-full",children:[a.jsx(z,{children:a.jsx(I,{className:"text-xl font-bold text-primary",children:"Subsídios dos Deputados Estaduais"})}),a.jsx(H,{children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-[15px]",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ano/Legislatura"}),a.jsx(d,{value:p,onChange:e=>y(e.target.value),placeholder:"2020/2024"})]}),a.jsxs("div",{className:"ml-[-5px] w-[90px]",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Valor"}),a.jsx("div",{className:"relative",children:a.jsx(d,{value:D,onChange:e=>L(e.target.value),placeholder:"0,00"})})]}),a.jsxs("div",{className:"ml-[-40px] w-[120px]",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fixado pela Lei"}),a.jsx(d,{value:C,onChange:e=>w(e.target.value),placeholder:"1.111/11"})]}),a.jsxs("div",{className:"ml-[-43px]",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Data entrada em vigor"}),a.jsxs("div",{className:"relative",children:[a.jsx(d,{type:"date",value:x,onChange:e=>U(e.target.value),className:"pl-10"}),a.jsx(ea,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500",size:16})]})]})]})})]}),a.jsxs($,{className:"md:col-span-1 h-full",children:[a.jsx(z,{children:a.jsx(I,{className:"text-xl font-bold text-primary",children:"Subsídios dos Ministros do STF"})}),a.jsx(H,{children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-[15px]",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ano/Legislatura"}),a.jsx(d,{value:R,onChange:e=>W(e.target.value),placeholder:"2020/2024"})]}),a.jsxs("div",{className:"ml-[-5px] w-[90px]",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Valor"}),a.jsx("div",{className:"relative",children:a.jsx(d,{value:J,onChange:e=>X(e.target.value),placeholder:"0,00"})})]}),a.jsxs("div",{className:"ml-[-40px] w-[120px]",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fixado pela Lei"}),a.jsx(d,{value:G,onChange:e=>K(e.target.value),placeholder:"1.111/11"})]}),a.jsxs("div",{className:"ml-[-43px]",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Data entrada em vigor"}),a.jsxs("div",{className:"relative",children:[a.jsx(d,{type:"date",value:Y,onChange:e=>Z(e.target.value),className:"pl-10"}),a.jsx(ea,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500",size:16})]})]})]})})]}),a.jsxs($,{className:"mt-[10px] md:col-span-2",children:[a.jsx(z,{children:a.jsx(I,{className:"text-xl font-bold text-primary",children:"Percentuais do salário de Deputados Estaduais a ser utilizado para cálculo por habitante"})}),a.jsx(H,{children:a.jsxs("div",{className:"space-y-4",children:[g.map((e,s)=>a.jsx(pa,{index:s,maximo:e.maximo,minimo:e.minimo,porcentagem:e.porcentagem,onMaximoChange:t=>P(e.id,"maximo",t),onMinimoChange:t=>P(e.id,"minimo",t),onPorcentagemChange:t=>P(e.id,"porcentagem",t),onRemove:()=>oa(e.id),isRemovable:g.length>1},e.id)),a.jsx("div",{className:"mt-4",children:a.jsx(Q,{type:"button",variant:"outline",onClick:ta,className:"text-secondary border-secondary hover:text-secondary/95",children:"Adicionar Nova Faixa"})})]})})]})]}),a.jsx("div",{className:"mt-6 flex justify-end",children:a.jsx(Q,{type:"submit",className:"bg-secondary hover:bg-secondary/90",children:"Salvar Dados"})})]})]})]})]})};export{La as default};
