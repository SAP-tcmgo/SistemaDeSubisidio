import{j as e,u as U,r as l}from"./vendor-others-Di0KkQDI.js";import{S as X,H as J}from"./Sidebar-BZGUXzy7.js";import{B as W,I as Y,C}from"./BreadcrumbNav-BtnZ638B.js";import{I as u}from"./input-xcPInw0g.js";import{T as Z}from"./textarea-FA1FH-ZB.js";import{L as F}from"./label-C-u4K59m.js";import{b as _,T as ee,f as ae,g as se,h as oe,d as $}from"./main-ByvVTPME.js";import{f as re,X as ie,I as te,i as le}from"./vendor-lucide-DmcWVqu_.js";import{q as w,c as P,w as E,n as A,e as R}from"./vendor-firebase-DUe4cX6Q.js";import"./vendor-react-query-De-ebuA0.js";const de=({isValid:v})=>v?e.jsx("div",{className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center text-white",children:e.jsx(re,{size:16})}):e.jsx("div",{className:"w-6 h-6 bg-red-500 rounded-full flex items-center justify-center text-white",children:e.jsx(ie,{size:16})}),je=()=>{const v=U(),{numeroProcesso:D,numeroHabitantes:g}=_(),[b,L]=l.useState(!1),[j,N]=l.useState(null),[x,V]=l.useState(null),[S,y]=l.useState([]),[K,I]=l.useState({prefeito:{isValid:!0,message:null},vicePrefeito:{isValid:!0,message:null},secretarios:{isValid:!0,message:null},vereadores:{isValid:!0,message:null},presidenteCamara:{isValid:!0,message:null}}),[o,f]=l.useState({atoNormativo:"",legislatura:"",dataFixacao:"",anotacaoPlanilha:!0,numeroLei:"",numeroAcordao:"",ressalvaLivre:!1,"valor-0":"","valor-1":"","valor-2":"","valor-3":"","valor-4":""}),[ne,q]=l.useState(0),O=[{cargo:"Prefeito",valorKey:"valor-0",validationKey:"prefeito"},{cargo:"Vice-Prefeito",valorKey:"valor-1",validationKey:"vicePrefeito"},{cargo:"Secretários",valorKey:"valor-2",validationKey:"secretarios"},{cargo:"Vereadores",valorKey:"valor-3",validationKey:"vereadores"},{cargo:"Presidente da Câmara",valorKey:"valor-4",validationKey:"presidenteCamara"}],h=s=>{if(!s)return 0;const a=s.replace(/[^\d,]/g,"").replace(",",".");return parseFloat(a)||0},M=()=>{L(!b)},H=()=>{console.log("Clear screen action triggered"),f({atoNormativo:"",legislatura:"",dataFixacao:"",anotacaoPlanilha:!0,numeroLei:"",numeroAcordao:"",ressalvaLivre:!1}),q(0)};l.useEffect(()=>{(async()=>{if(!o.legislatura){N(null),V(null),y([]);return}try{const a=w(P($,"SubsidiosDeputadosEstaduais"),E("AnoLegislatura","==",o.legislatura),A(1)),r=await R(a);r.empty?N(null):N(r.docs[0].data());const d=w(P($,"SubsidiosMinistrosSTF"),E("AnoLegislatura","==",o.legislatura),A(1)),n=await R(d);n.empty?V(null):V(n.docs[0].data());const c=w(P($,"PercentualSalarioDep")),i=(await R(c)).docs.map(t=>t.data());y(i)}catch(a){console.error("Erro ao buscar dados do Firebase:",a),N(null),V(null),y([])}})()},[o.legislatura]);const T=l.useMemo(()=>{const s={prefeito:{isValid:!0,message:null},vicePrefeito:{isValid:!0,message:null},secretarios:{isValid:!0,message:null},vereadores:{isValid:!0,message:null},presidenteCamara:{isValid:!0,message:null}},a=h(o["valor-0"]),r=h(o["valor-1"]),d=h(o["valor-2"]),n=h(o["valor-3"]),c=h(o["valor-4"]);if(a>0&&x?a>=x.Valor&&(s.prefeito={isValid:!1,message:`Subsídio do Prefeito (R$ ${a.toFixed(2)}) deve ser menor que o do Ministro STF (R$ ${x.Valor.toFixed(2)}).`}):a>0&&!x&&(s.prefeito={isValid:!1,message:`Dados do subsídio STF para a legislatura ${o.legislatura} não encontrados.`}),r>0&&a>0&&r>=a&&(s.vicePrefeito={isValid:!1,message:`Subsídio do Vice-Prefeito (R$ ${r.toFixed(2)}) deve ser menor que o do Prefeito (R$ ${a.toFixed(2)}).`}),d>0&&a>0&&d>=a&&(s.secretarios={isValid:!1,message:`Subsídio dos Secretários (R$ ${d.toFixed(2)}) deve ser menor que o do Prefeito (R$ ${a.toFixed(2)}).`}),j&&S.length>0&&a>0){const m=S.sort((i,t)=>i.RangeStart-t.RangeStart).find(i=>g>=i.RangeStart&&(i.RangeEnd===null||g<=i.RangeEnd));if(m){const i=m.PercentageValue/100,t=j.Valor*i;n>0&&(n>=t?s.vereadores={isValid:!1,message:`Subsídio (R$ ${n.toFixed(2)}) excede o teto de ${m.PercentageValue}% do Dep. Estadual (Teto: R$ ${t.toFixed(2)}).`}:t>=a&&(s.vereadores={isValid:!1,message:`Teto calculado (R$ ${t.toFixed(2)}) é maior ou igual ao subsídio do Prefeito (R$ ${a.toFixed(2)}).`})),c>0&&(c>=t?s.presidenteCamara={isValid:!1,message:`Subsídio (R$ ${c.toFixed(2)}) excede o teto de ${m.PercentageValue}% do Dep. Estadual (Teto: R$ ${t.toFixed(2)}).`}:t>=a&&(s.presidenteCamara={isValid:!1,message:`Teto calculado (R$ ${t.toFixed(2)}) é maior ou igual ao subsídio do Prefeito (R$ ${a.toFixed(2)}).`}))}else{const i=`Faixa percentual para ${g} habitantes não encontrada.`;n>0&&(s.vereadores={isValid:!1,message:i}),c>0&&(s.presidenteCamara={isValid:!1,message:i})}}else if((n>0||c>0)&&(!j||S.length===0)){const m=`Dados de Dep. Estadual ou Percentuais para a legislatura ${o.legislatura} não encontrados.`;n>0&&(s.vereadores={isValid:!1,message:m}),c>0&&(s.presidenteCamara={isValid:!1,message:m})}return s},[o,j,x,S,g]);l.useEffect(()=>{I(T)},[T]);const z=["1 - Ausência de Documentação Essencial","2 -A fixação dos subsídios do Prefeito, do Vice-Prefeito, dos Secretários e dos Vereadores, NÃO deu-se mediante lei de iniciativa da Câmara.","3 - NÃO houve declaração do Prefeito no ato de sanção","4 - A fixação do subsídio dos vereadores ocorreu por meio de outra norma.","5 -A Lei que fixou os subsídios dos vereadores NÃO deu-se mediante iniciativa da Câmara.","6 -Subsídio fixado excede ao teto regulamentar.","7 - Houve Desobediência ao Princípio da Anterioridade.","8 -houve alteração de norma para retirar a exigência da anterioridade","9 -Existe divergência entres als fixatório e Lei Municipal.","10 -O total da despesa com a remuneração dos vereadores ultrapassa o montante de 5% da receita do município.","11- Houve Desobedencia ao Princípio da Generalidade"],p=s=>{const{name:a,value:r}=s.target;f(d=>({...d,[a]:r}))},k=(s,a)=>{f(r=>({...r,[s]:a}))},B=()=>{H()},Q=()=>{v("/TratamentoLeis")},G=()=>{v("/Fixacao")};return e.jsx("div",{className:"municipios-theme flex min-h-screen flex-col bg-gray-50",children:e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(X,{isOpen:b,setIsOpen:L}),e.jsxs("div",{className:`transition-all duration-300 ${b?"ml-64":"ml-0"}`,children:[e.jsx("div",{className:"flex justify-between items-center",children:e.jsx(J,{toggleSidebar:M})}),e.jsx(W,{currentPage:"Fixação",sidebarOpen:b}),e.jsx("main",{className:"min-h-screen bg-pattern bg-gray-100 py-8 px-4 ",children:e.jsx("div",{className:"max-w-5xl mx-auto bg-white rounded-lg shadow-md overflow-hidden ",children:e.jsxs("div",{className:"p-6 ",children:[e.jsx("div",{className:"mt-[-20px] flex justify-end",children:e.jsx(Y,{onEraseClick:B,onBackClick:Q,onNextClick:G})}),e.jsx("div",{className:"relative mb-8 text-primary text-center",children:e.jsxs("h1",{className:"text-2xl font-bold text-center mb-4 mt-[-20px]",children:["Fixação ",D&&`(${D})`]})}),e.jsxs("div",{className:"mb-6 space-y-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 md:items-center",children:[e.jsx(F,{htmlFor:"atoNormativo",className:"text-base font-medium w-128",children:"Ato Normativo que concedeu a Fixação dos Subsídios n.:"}),e.jsx(u,{id:"atoNormativo",name:"atoNormativo",value:o.atoNormativo,onChange:p,className:"w-[100px] md:max-w-xs",placeholder:"1.500/00"})]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 md:items-center",children:[e.jsx(F,{htmlFor:"legislatura",className:"text-base font-medium w-18",children:"A fixação dos subsídios refere-se a qual legislatura:"}),e.jsx(u,{id:"legislatura",name:"legislatura",value:o.legislatura,onChange:p,className:"w-[100px] md:max-w-xs",placeholder:"2020-2024"})]})]}),e.jsxs("div",{className:"mb-8 w-[80%] md:w-full",children:[e.jsx("h2",{className:"text-xl font-bold mb-4 text-center",children:"Sobre o valor dos subsídios:"}),e.jsxs("table",{className:"w-[70%] border-collapse text-center mx-auto",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-100",children:[e.jsx("th",{className:"w-64 border p-2 text-center",children:"Agente Político"}),e.jsx("th",{className:"border p-2 text-center",children:"Valor dos Subsídios"}),e.jsx("th",{className:"border p-2 text-center",children:"Válido?"})]})}),e.jsx("tbody",{children:O.map(s=>{const a=K[s.validationKey]||{isValid:!0,message:null},r=!!o[s.valorKey];return e.jsxs("tr",{children:[e.jsx("td",{className:"border p-2 text-left",children:s.cargo}),e.jsx("td",{className:"border-b p-2 flex text-center justify-center",children:e.jsx(u,{type:"text",name:s.valorKey,value:o[s.valorKey]||"",onChange:d=>f({...o,[s.valorKey]:d.target.value}),className:"w-32",placeholder:"R$ 0,00"})}),e.jsx("td",{className:"border p-2 w-22",children:r&&e.jsxs("div",{className:"flex justify-center items-center gap-1",children:[e.jsx(de,{isValid:a.isValid}),!a.isValid&&a.message&&e.jsx(ee,{delayDuration:100,children:e.jsxs(ae,{children:[e.jsx(se,{children:e.jsx(te,{size:16,className:"text-red-600 cursor-help"})}),e.jsx(oe,{className:"bg-black text-white",children:e.jsx("p",{children:a.message})})]})})]})})]},s.validationKey)})})]})]}),e.jsxs("div",{className:"mb-6 flex flex-col md:flex-row gap-4 md:items-center",children:[e.jsx("span",{className:"text-base font-medium",children:"Data da Fixação:"}),e.jsxs("div",{className:"relative max-w-xs",children:[e.jsx(u,{name:"dataFixacao",value:o.dataFixacao,onChange:p,className:"pl-10",placeholder:"24/04/2000"}),e.jsx(le,{className:"absolute left-3 top-2.5 text-gray-500 h-5 w-5"})]})]}),e.jsxs("div",{className:"mb-6 flex items-center gap-2 border p-4 rounded bg-blue-50",children:[e.jsx(C,{id:"anotacao",checked:o.anotacaoPlanilha,onCheckedChange:s=>k("anotacaoPlanilha",!!s)}),e.jsx("label",{htmlFor:"anotacao",className:"text-blue-800 font-medium",children:"Anotação na planilha de controle de gastos"})]}),e.jsx("div",{className:"mb-8 p-4 border rounded-md bg-gray-50 text-sm",children:e.jsxs("p",{className:"mb-2",children:["Trata-se de procedimento de anotação, para fins de controle de gastos, da Lei nº",e.jsx(u,{name:"numeroLei",value:o.numeroLei,onChange:p,className:"inline-block w-24 mx-1",placeholder:"000/000"})," que que fixou os subsídios dos agentes políticos de MUNICÍPIO para a legislatura ",e.jsx("span",{className:"bg-white border px-2 py-0.5 rounded",children:"2020-2024"})," do Setor de Recursos, com a informação de que os dados da planilha de subsídios",e.jsx("span",{className:"bg-white border px-2 py-0.5 rounded mx-1",children:"2020-2023"})," foram atualizados em consonância com o disposto no Acórdão nº",e.jsx(u,{name:"numeroAcordao",value:o.numeroAcordao,onChange:p,className:"inline-block w-24 mx-1",placeholder:"000/000"}),"."]})}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-lg font-bold mb-4",children:"Vícios ou Ressalvas da Fixação de Subsídios:"}),e.jsx("div",{className:"space-y-2",children:z.map((s,a)=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(C,{id:`vicio-${a}`,checked:o[`vicio-${a}`]||!1,onCheckedChange:r=>f({...o,[`vicio-${a}`]:!!r})}),e.jsx(F,{htmlFor:`vicio-${a}`,className:"text-base font-normal",children:s})]},a))})]}),e.jsxs("div",{className:"mb-8 flex items-center gap-2",children:[e.jsx(C,{id:"ressalvaLivre",checked:o.ressalvaLivre,onCheckedChange:s=>k("ressalvaLivre",!!s)}),e.jsx("label",{htmlFor:"ressalvaLivre",className:"font-medium",children:"Inserir Ressalva Livre"})]}),o.ressalvaLivre&&e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"font-medium mb-2",children:"Ressalva"}),e.jsx(Z,{className:"w-full h-32"})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Conferência do Texto de Fixação de Subsídios"}),e.jsx("div",{className:"border rounded-md w-full h-64"})]})]})})})]})]})})};export{je as default};
