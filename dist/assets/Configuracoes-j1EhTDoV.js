import{p as W,r as o,j as e,q as X,S as Y,s as Z,u as ee,v as se,n as ae,w as re,x as oe}from"./vendor-others-CnHLUX9e.js";import{c as C,e as te,u as ne,a as L,d as T}from"./main-1fmfMNLN.js";import{c as I,e as q,k as A,q as ie,w as le,T as ce,f as de}from"./vendor-firebase-CsHq2m9l.js";/* empty css                                    */import{C as $,a as G,b as me,c as xe}from"./card-_nGB1AWh.js";import{I as u}from"./input-CzX8_0F_.js";import{B as f}from"./button-CHAtIAMY.js";import{L as ue}from"./label-PSaLDb4s.js";import{A as V,U as fe,M as he,S as pe,b as je,c as ge}from"./vendor-lucide-0MdzRPOT.js";import"./vendor-react-query-BsC494l1.js";const be=W,O=o.createContext({}),N=({...r})=>e.jsx(O.Provider,{value:{name:r.name},children:e.jsx(X,{...r})}),y=()=>{const r=o.useContext(O),a=o.useContext(U),{getFieldState:t,formState:i}=Z(),l=t(r.name,i);if(!r)throw new Error("useFormField should be used within <FormField>");const{id:n}=a;return{id:n,name:r.name,formItemId:`${n}-form-item`,formDescriptionId:`${n}-form-item-description`,formMessageId:`${n}-form-item-message`,...l}},U=o.createContext({}),p=o.forwardRef(({className:r,...a},t)=>{const i=o.useId();return e.jsx(U.Provider,{value:{id:i},children:e.jsx("div",{ref:t,className:C("space-y-2",r),...a})})});p.displayName="FormItem";const j=o.forwardRef(({className:r,...a},t)=>{const{error:i,formItemId:l}=y();return e.jsx(ue,{ref:t,className:C(i&&"text-destructive",r),htmlFor:l,...a})});j.displayName="FormLabel";const g=o.forwardRef(({...r},a)=>{const{error:t,formItemId:i,formDescriptionId:l,formMessageId:n}=y();return e.jsx(Y,{ref:a,id:i,"aria-describedby":t?`${l} ${n}`:`${l}`,"aria-invalid":!!t,...r})});g.displayName="FormControl";const ve=o.forwardRef(({className:r,...a},t)=>{const{formDescriptionId:i}=y();return e.jsx("p",{ref:t,id:i,className:C("text-sm text-muted-foreground",r),...a})});ve.displayName="FormDescription";const Ne=o.forwardRef(({className:r,children:a,...t},i)=>{const{error:l,formMessageId:n}=y(),h=l?String(l==null?void 0:l.message):a;return h?e.jsx("p",{ref:i,id:n,className:C("text-sm font-medium text-destructive",r),...t,children:h}):null});Ne.displayName="FormMessage";function ze(){const r=ee(),[a,t]=o.useState("perfil"),[i,l]=o.useState(!1),[n,h]=o.useState(!1),[b,E]=o.useState(""),[R,z]=o.useState([]),{userRoles:D,userName:w,userEmail:x,usercpf:k,updateUser:B}=te();o.useEffect(()=>{(async()=>{const m=I(T,"cargos"),v=(await q(m)).docs.map(P=>P.data().nome);z(v)})()},[]);const H=async()=>{if(b.trim()!=="")try{const s=I(T,"cargos");await A(s,{nome:b}),z([...R,b]),E(""),c({title:"Cargo adicionado com sucesso!",className:"bg-green-500 text-white"})}catch(s){console.error("Erro ao adicionar cargo:",s),c({title:"Erro ao adicionar cargo. Tente novamente.",variant:"destructive"})}},{toast:c}=ne(),[F,M]=o.useState(null),_=async()=>{try{const s=I(T,"tokens"),m=ie(s,le("usado","==",!1)),S=await q(m);if(!S.empty){const Q=S.docs[0].data().token;M(Q),l(!0);return}const v=oe();await A(s,{data_geracao:ce.now(),token:v,usado:!1}),M(v)}catch(s){console.error("Error generating token:",s),c({title:"Erro ao gerar token",description:"Tente novamente.",variant:"destructive"})}},J=()=>{x&&de(L,x).then(()=>{console.log("Link de redefinição de senha enviado com sucesso para: "+x),c({title:"Link de redefinição enviado",description:"Verifique seu e-mail para redefinir sua senha."})}).catch(s=>{let m="Ocorreu um erro ao enviar o email de redefinição. Verifique se o email está correto.";s.code==="auth/user-not-found"&&(m="E-mail não encontrado no banco de dados."),c({title:"Erro ao enviar email de redefinição",description:m,variant:"destructive"}),console.error("Erro ao enviar o link de redefinição de senha:",s)})},d=se({defaultValues:{nome:w,email:x,cargos:D,cpf:k}});o.useEffect(()=>{d.reset({nome:w,email:x,cpf:k})},[w,x,k,d]);const K=async s=>{console.log("Form submitted:",s);try{await B({userName:s.nome,userEmail:s.email,usercpf:s.cpf}),c({title:"Perfil atualizado com sucesso!",className:"bg-green-500 text-white"})}catch(m){console.error("Erro ao atualizar o perfil:",m),c({title:"Erro ao atualizar o perfil. Tente novamente.",variant:"destructive"})}};return e.jsx("div",{className:"dashboard-theme container mx-auto py-6 px-4 md:px-6",children:e.jsxs(ae.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:[e.jsxs("div",{className:"flex items-center mb-6 cursor-pointer",onClick:()=>r("/telaInicial"),children:[e.jsx(V,{className:"mr-2 text-tribunal-blue",size:24}),e.jsx("h1",{className:"text-3xl font-bold text-tribunal-blue",children:"Configurações"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-6",children:[e.jsx($,{className:"md:col-span-3 shadow-md",children:e.jsx(G,{className:"p-0",children:e.jsxs("nav",{className:"flex flex-col",children:[[{id:"perfil",label:"Perfil",icon:e.jsx(fe,{size:18})},{id:"conta",label:"Conta",icon:e.jsx(he,{size:18})},{id:"admin",label:"Área de administrador",icon:e.jsx(pe,{size:18})}].map(s=>e.jsxs("button",{className:`flex items-center gap-3 p-4 text-left transition-colors hover:bg-gray-100 ${a===s.id?"bg-tribunal-gold/10 text-tribunal-gold border-l-4 border-tribunal-gold":"text-gray-700"}`,onClick:()=>t(s.id),children:[s.icon,e.jsx("span",{children:s.label})]},s.id)),e.jsxs("button",{className:"flex items-center gap-3 p-4 text-left text-red-500 hover:bg-red-50 mt-auto border-t",onClick:()=>{window.confirm("Deseja realmente sair?")&&L.signOut().then(()=>{r("/login")})},children:[e.jsx(je,{size:18}),e.jsx("span",{children:"Sair"})]})]})})}),e.jsxs($,{className:"md:col-span-9 shadow-md",children:[e.jsx(me,{children:e.jsxs(xe,{className:"text-2xl text-tribunal-blue",children:[a==="perfil"&&"Informações de Perfil",a==="conta"&&"Configurações de Conta",a==="seguranca"&&"Segurança",a==="admin"&&e.jsxs(e.Fragment,{children:[n&&e.jsxs("div",{className:"flex items-center cursor-pointer",onClick:()=>h(!1),children:[e.jsx(V,{className:"mr-2 text-tribunal-blue",size:24}),e.jsx("span",{children:"Área de administrador"})]}),!n&&e.jsx("span",{children:"Área de administrador"})]})]})}),e.jsx(G,{children:e.jsx(be,{...d,children:e.jsxs("form",{onSubmit:d.handleSubmit(s=>{a==="perfil"&&K(s)}),className:"space-y-6",children:[a==="perfil"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex flex-col sm:flex-row gap-6 items-start rounded-lg border p-4",children:e.jsx("div",{className:"flex-1 space-y-4 ",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx(N,{control:d.control,name:"nome",render:({field:s})=>e.jsxs(p,{children:[e.jsx(j,{children:"Nome completo"}),e.jsx(g,{children:e.jsx(u,{...s})})]})}),e.jsx(N,{control:d.control,name:"cpf",render:({field:s})=>e.jsxs(p,{children:[e.jsx(j,{children:"CPF"}),e.jsx(g,{children:e.jsx(u,{...s})})]})}),e.jsx(N,{control:d.control,name:"email",render:({field:s})=>e.jsxs(p,{children:[e.jsx(j,{children:"Email"}),e.jsx(g,{children:e.jsx(u,{...s,type:"email"})})]})}),e.jsx(N,{control:d.control,name:"cargos",render:({field:s})=>e.jsxs(p,{children:[e.jsx(j,{children:"Cargos"}),e.jsx(g,{children:e.jsx(u,{...s,value:D.join(", "),disabled:!0})})]})})]})})}),e.jsx("div",{className:"flex justify-end space-x-4 pt-4 border-t",children:e.jsx(f,{type:"submit",className:"bg-tribunal-gold hover:bg-tribunal-gold/90",children:"Salvar alterações"})})]}),a==="conta"&&e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"rounded-lg border p-4",children:[e.jsx("div",{className:"font-medium",children:"Alterar senha"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Receba um e-mail para alterar sua senha."}),e.jsx(f,{variant:"outline",onClick:J,children:"Alterar senha"})]})}),a==="admin"&&e.jsxs("div",{className:"space-y-4",children:[!n&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"rounded-lg border p-4",children:[e.jsx("div",{className:"font-medium",children:"Cargos"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Área para edição e inclusão de cargos."}),e.jsx(f,{variant:"outline",onClick:()=>h(!n),children:"Cargos"})]}),e.jsxs("div",{className:"rounded-lg border p-4",children:[e.jsx("div",{className:"font-medium",children:"Gerar Token"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Gere um Token para um novo cadastro."}),e.jsx(f,{variant:"outline",onClick:_,children:"Gerar Token"}),i&&F&&e.jsxs("div",{className:"flex items-center space-x-2 mt-2",children:[e.jsx(u,{type:"text",value:F,readOnly:!0,className:"w-full md:w-auto"}),e.jsx(re.CopyToClipboard,{text:F,onCopy:()=>c({title:"Token copiado",description:"Token copiado para a área de transferência."}),children:e.jsx(f,{variant:"outline",children:"Copiar Token"})})]})]})]}),n&&e.jsxs("div",{className:"flex justify-between rounded-lg border p-4",children:[e.jsxs("div",{className:"w-1/3",children:[e.jsxs("div",{className:"relative w-full",children:[e.jsx(u,{type:"text",placeholder:"Novo cargo",value:b,onChange:s=>E(s.target.value),className:"w-full pl-8"}),e.jsx(ge,{className:"absolute left-2 top-1/2 transform -translate-y-1/2 text-tribunal-blue",size:20})]}),e.jsx(f,{onClick:H,className:"mt-2",children:"Adicionar Cargo"})]}),e.jsxs("div",{className:"w-1/2 flex flex-col items-center justify-center",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4 text-tribunal-blue",children:"Cargos existentes"}),e.jsx("ul",{className:"list-disc list-inside bg-gray-100 p-4 rounded-lg shadow-md",children:R.map(s=>e.jsx("li",{className:"py-1 text-gray-700",children:s},s))})]})]})]})]})})})]})]})]})})}export{ze as default};
